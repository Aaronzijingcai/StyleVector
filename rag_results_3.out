
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.56s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.49s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.80s/it]
Device set to use cuda:3

Generating RAG-based reviews:   0%|          | 0/1822 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/home/caizijing/miniconda3/envs/ai/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:628: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/caizijing/miniconda3/envs/ai/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

Generating RAG-based reviews:   1%|          | 16/1822 [06:38<12:28:57, 24.88s/ examples]
Generating RAG-based reviews:   2%|▏         | 32/1822 [12:41<11:44:34, 23.62s/ examples]
Generating RAG-based reviews:   3%|▎         | 48/1822 [18:41<11:22:59, 23.10s/ examples]
Generating RAG-based reviews:   4%|▎         | 64/1822 [24:32<11:03:18, 22.64s/ examples]This is a friendly reminder - the current text generation call will exceed the model's predefined maximum length (4096). Depending on the model, you may observe exceptions, performance degradation, or nothing at all.

Generating RAG-based reviews:   4%|▍         | 80/1822 [31:16<11:24:24, 23.57s/ examples]
Generating RAG-based reviews:   5%|▌         | 96/1822 [35:56<10:19:12, 21.53s/ examples]
Generating RAG-based reviews:   6%|▌         | 112/1822 [41:52<10:19:52, 21.75s/ examples]
Generating RAG-based reviews:   7%|▋         | 128/1822 [47:27<10:06:41, 21.49s/ examples]
Generating RAG-based reviews:   8%|▊         | 144/1822 [52:38<9:43:09, 20.85s/ examples] 
Generating RAG-based reviews:   9%|▉         | 160/1822 [58:09<9:36:21, 20.81s/ examples]You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset

Generating RAG-based reviews:  10%|▉         | 176/1822 [1:03:05<9:11:16, 20.09s/ examples]
Generating RAG-based reviews:  11%|█         | 192/1822 [1:09:57<9:52:41, 21.82s/ examples]
Generating RAG-based reviews:  11%|█▏        | 208/1822 [1:17:09<10:28:58, 23.38s/ examples]
Generating RAG-based reviews:  12%|█▏        | 224/1822 [1:23:38<10:30:20, 23.67s/ examples]
Generating RAG-based reviews:  13%|█▎        | 240/1822 [1:27:49<9:20:45, 21.27s/ examples] 
Generating RAG-based reviews:  14%|█▍        | 256/1822 [1:32:50<8:55:44, 20.53s/ examples]
Generating RAG-based reviews:  15%|█▍        | 272/1822 [1:38:22<8:51:47, 20.59s/ examples]
Generating RAG-based reviews:  16%|█▌        | 288/1822 [1:44:27<9:03:39, 21.26s/ examples]
Generating RAG-based reviews:  17%|█▋        | 304/1822 [1:49:28<8:39:21, 20.53s/ examples]
Generating RAG-based reviews:  18%|█▊        | 320/1822 [1:54:42<8:26:45, 20.24s/ examples]
Generating RAG-based reviews:  18%|█▊        | 336/1822 [1:59:10<7:55:40, 19.21s/ examples]
Generating RAG-based reviews:  19%|█▉        | 352/1822 [2:05:29<8:23:21, 20.55s/ examples]
Generating RAG-based reviews:  20%|██        | 368/1822 [2:11:59<8:46:00, 21.71s/ examples]
Generating RAG-based reviews:  21%|██        | 384/1822 [2:16:41<8:10:47, 20.48s/ examples]
Generating RAG-based reviews:  22%|██▏       | 400/1822 [2:21:55<7:59:06, 20.22s/ examples]
Generating RAG-based reviews:  23%|██▎       | 416/1822 [2:27:38<8:02:18, 20.58s/ examples]
Generating RAG-based reviews:  24%|██▎       | 432/1822 [2:32:43<7:46:29, 20.14s/ examples]
Generating RAG-based reviews:  25%|██▍       | 448/1822 [2:36:39<7:03:45, 18.50s/ examples]
Generating RAG-based reviews:  25%|██▌       | 464/1822 [2:41:48<7:04:30, 18.76s/ examples]
Generating RAG-based reviews:  26%|██▋       | 480/1822 [2:47:43<7:22:42, 19.79s/ examples]
Generating RAG-based reviews:  27%|██▋       | 496/1822 [2:52:49<7:12:46, 19.58s/ examples]
Generating RAG-based reviews:  28%|██▊       | 512/1822 [2:58:05<7:08:38, 19.63s/ examples]
Generating RAG-based reviews:  29%|██▉       | 528/1822 [3:03:38<7:11:08, 19.99s/ examples]
Generating RAG-based reviews:  30%|██▉       | 544/1822 [3:10:02<7:31:09, 21.18s/ examples]
Generating RAG-based reviews:  31%|███       | 560/1822 [3:13:57<6:44:48, 19.25s/ examples]
Generating RAG-based reviews:  32%|███▏      | 576/1822 [3:19:33<6:50:24, 19.76s/ examples]
Generating RAG-based reviews:  32%|███▏      | 592/1822 [3:25:07<6:51:54, 20.09s/ examples]
Generating RAG-based reviews:  33%|███▎      | 608/1822 [3:31:17<7:04:56, 21.00s/ examples]
Generating RAG-based reviews:  34%|███▍      | 624/1822 [3:36:44<6:56:02, 20.84s/ examples]
Generating RAG-based reviews:  35%|███▌      | 640/1822 [3:43:13<7:11:05, 21.88s/ examples]
Generating RAG-based reviews:  36%|███▌      | 656/1822 [3:48:18<6:48:48, 21.04s/ examples]
Generating RAG-based reviews:  37%|███▋      | 672/1822 [3:53:19<6:30:19, 20.37s/ examples]
Generating RAG-based reviews:  38%|███▊      | 688/1822 [3:58:49<6:26:36, 20.46s/ examples]
Generating RAG-based reviews:  39%|███▊      | 704/1822 [4:04:48<6:32:10, 21.05s/ examples]
Generating RAG-based reviews:  40%|███▉      | 720/1822 [4:08:33<5:48:05, 18.95s/ examples]
Generating RAG-based reviews:  40%|████      | 736/1822 [4:14:04<5:52:31, 19.48s/ examples]
Generating RAG-based reviews:  41%|████▏     | 752/1822 [4:19:41<5:55:40, 19.94s/ examples]
Generating RAG-based reviews:  42%|████▏     | 768/1822 [4:26:09<6:12:54, 21.23s/ examples]
Generating RAG-based reviews:  43%|████▎     | 784/1822 [4:31:47<6:06:48, 21.20s/ examples]
Generating RAG-based reviews:  44%|████▍     | 800/1822 [4:35:54<5:31:40, 19.47s/ examples]
Generating RAG-based reviews:  45%|████▍     | 816/1822 [4:43:20<6:08:47, 22.00s/ examples]
Generating RAG-based reviews:  46%|████▌     | 832/1822 [4:48:47<5:55:07, 21.52s/ examples]
Generating RAG-based reviews:  47%|████▋     | 848/1822 [4:54:36<5:50:48, 21.61s/ examples]
Generating RAG-based reviews:  47%|████▋     | 864/1822 [5:00:30<5:47:35, 21.77s/ examples]
Generating RAG-based reviews:  48%|████▊     | 880/1822 [5:04:38<5:12:09, 19.88s/ examples]
Generating RAG-based reviews:  49%|████▉     | 896/1822 [5:10:05<5:09:27, 20.05s/ examples]
Generating RAG-based reviews:  50%|█████     | 912/1822 [5:15:36<5:06:56, 20.24s/ examples]
Generating RAG-based reviews:  51%|█████     | 928/1822 [5:20:38<4:55:35, 19.84s/ examples]
Generating RAG-based reviews:  52%|█████▏    | 944/1822 [5:25:05<4:36:32, 18.90s/ examples]
Generating RAG-based reviews:  53%|█████▎    | 960/1822 [5:30:02<4:29:55, 18.79s/ examples]
Generating RAG-based reviews:  54%|█████▎    | 976/1822 [5:35:55<4:38:41, 19.77s/ examples]
Generating RAG-based reviews:  54%|█████▍    | 992/1822 [5:40:10<4:17:45, 18.63s/ examples]
Generating RAG-based reviews:  55%|█████▌    | 1008/1822 [5:44:13<3:58:40, 17.59s/ examples]
Generating RAG-based reviews:  56%|█████▌    | 1024/1822 [5:50:49<4:22:27, 19.73s/ examples]
Generating RAG-based reviews:  57%|█████▋    | 1040/1822 [5:57:01<4:30:55, 20.79s/ examples]
Generating RAG-based reviews:  58%|█████▊    | 1056/1822 [6:04:45<4:56:56, 23.26s/ examples]
Generating RAG-based reviews:  59%|█████▉    | 1072/1822 [6:09:41<4:32:54, 21.83s/ examples]
Generating RAG-based reviews:  60%|█████▉    | 1088/1822 [6:14:13<4:09:18, 20.38s/ examples]
Generating RAG-based reviews:  61%|██████    | 1104/1822 [6:21:12<4:24:40, 22.12s/ examples]
Generating RAG-based reviews:  61%|██████▏   | 1120/1822 [6:26:45<4:14:12, 21.73s/ examples]
Generating RAG-based reviews:  62%|██████▏   | 1136/1822 [6:30:32<3:42:38, 19.47s/ examples]
Generating RAG-based reviews:  63%|██████▎   | 1152/1822 [6:36:53<3:52:00, 20.78s/ examples]
Generating RAG-based reviews:  64%|██████▍   | 1168/1822 [6:42:08<3:42:49, 20.44s/ examples]
Generating RAG-based reviews:  65%|██████▍   | 1184/1822 [6:46:08<3:20:02, 18.81s/ examples]
Generating RAG-based reviews:  66%|██████▌   | 1200/1822 [6:51:47<3:22:21, 19.52s/ examples]
Generating RAG-based reviews:  67%|██████▋   | 1216/1822 [6:58:00<3:28:37, 20.66s/ examples]
Generating RAG-based reviews:  68%|██████▊   | 1232/1822 [7:04:02<3:28:53, 21.24s/ examples]
Generating RAG-based reviews:  68%|██████▊   | 1248/1822 [7:08:33<3:11:01, 19.97s/ examples]
Generating RAG-based reviews:  69%|██████▉   | 1264/1822 [7:11:51<2:44:23, 17.68s/ examples]
Generating RAG-based reviews:  70%|███████   | 1280/1822 [7:16:20<2:37:27, 17.43s/ examples]
Generating RAG-based reviews:  71%|███████   | 1296/1822 [7:22:28<2:47:27, 19.10s/ examples]
Generating RAG-based reviews:  72%|███████▏  | 1312/1822 [7:29:00<2:56:03, 20.71s/ examples]
Generating RAG-based reviews:  73%|███████▎  | 1328/1822 [7:33:38<2:42:16, 19.71s/ examples]
Generating RAG-based reviews:  74%|███████▍  | 1344/1822 [7:38:09<2:30:26, 18.88s/ examples]
Generating RAG-based reviews:  75%|███████▍  | 1360/1822 [7:41:59<2:14:58, 17.53s/ examples]
Generating RAG-based reviews:  76%|███████▌  | 1376/1822 [7:46:00<2:04:44, 16.78s/ examples]
Generating RAG-based reviews:  76%|███████▋  | 1392/1822 [7:52:23<2:15:38, 18.93s/ examples]
Generating RAG-based reviews:  77%|███████▋  | 1408/1822 [7:58:26<2:18:27, 20.07s/ examples]
Generating RAG-based reviews:  78%|███████▊  | 1424/1822 [8:05:08<2:23:11, 21.59s/ examples]
Generating RAG-based reviews:  79%|███████▉  | 1440/1822 [8:09:22<2:06:29, 19.87s/ examples]
Generating RAG-based reviews:  80%|███████▉  | 1456/1822 [8:13:29<1:53:05, 18.54s/ examples]
Generating RAG-based reviews:  81%|████████  | 1472/1822 [8:19:59<1:58:22, 20.29s/ examples]
Generating RAG-based reviews:  82%|████████▏ | 1488/1822 [8:26:59<2:02:53, 22.08s/ examples]
Generating RAG-based reviews:  83%|████████▎ | 1504/1822 [8:32:09<1:52:44, 21.27s/ examples]
Generating RAG-based reviews:  83%|████████▎ | 1520/1822 [8:36:58<1:42:10, 20.30s/ examples]
Generating RAG-based reviews:  84%|████████▍ | 1536/1822 [8:41:16<1:30:50, 19.06s/ examples]
Generating RAG-based reviews:  85%|████████▌ | 1552/1822 [8:47:19<1:30:38, 20.14s/ examples]
Generating RAG-based reviews:  86%|████████▌ | 1568/1822 [8:53:01<1:26:49, 20.51s/ examples]
Generating RAG-based reviews:  87%|████████▋ | 1584/1822 [8:58:34<1:21:44, 20.61s/ examples]
Generating RAG-based reviews:  88%|████████▊ | 1600/1822 [9:04:06<1:16:21, 20.64s/ examples]
Generating RAG-based reviews:  89%|████████▊ | 1616/1822 [9:08:25<1:06:16, 19.30s/ examples]
Generating RAG-based reviews:  90%|████████▉ | 1632/1822 [9:13:50<1:02:05, 19.61s/ examples]
Generating RAG-based reviews:  90%|█████████ | 1648/1822 [9:16:03<47:03, 16.23s/ examples]  
Generating RAG-based reviews:  91%|█████████▏| 1664/1822 [9:18:40<37:39, 14.30s/ examples]
Generating RAG-based reviews:  92%|█████████▏| 1680/1822 [9:21:14<30:30, 12.89s/ examples]
Generating RAG-based reviews:  93%|█████████▎| 1696/1822 [9:24:16<26:06, 12.43s/ examples]
Generating RAG-based reviews:  94%|█████████▍| 1712/1822 [9:26:35<20:44, 11.31s/ examples]
Generating RAG-based reviews:  95%|█████████▍| 1728/1822 [9:30:36<19:30, 12.45s/ examples]
Generating RAG-based reviews:  96%|█████████▌| 1744/1822 [9:33:51<16:04, 12.37s/ examples]
Generating RAG-based reviews:  97%|█████████▋| 1760/1822 [9:37:04<12:41, 12.28s/ examples]
Generating RAG-based reviews:  97%|█████████▋| 1776/1822 [9:39:54<09:01, 11.77s/ examples]
Generating RAG-based reviews:  98%|█████████▊| 1792/1822 [9:43:21<06:03, 12.13s/ examples]
Generating RAG-based reviews:  99%|█████████▉| 1808/1822 [9:46:50<02:53, 12.40s/ examples]
Generating RAG-based reviews: 100%|██████████| 1822/1822 [9:48:56<00:00, 11.48s/ examples]
Generating RAG-based reviews: 100%|██████████| 1822/1822 [9:48:56<00:00, 19.39s/ examples]
Average ROUGE-L: 0.1174
Average METEOR: 0.1249
